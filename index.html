<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>Portable Web Publications for the Open Web Platform</title>
    <link rel="stylesheet" type="text/css" href="extras.css" />
    <script src="https://www.w3.org/Tools/respec/respec-w3c-common" async="" class="remove"></script>
    <style type="text/css">
      code {
        font-size: 120%;
      }
    </style>
    <script class="remove">
      var respecConfig = {
         localBiblio: {
            "EPUB3": {
                "authors": [
                  "Garth Conboy",
                  "Matt Garrish",
                  "Markus Gylling",
                  "William McCoy",
                  "Murata Makoto",
                  "Daniel Weck"
                ],
                "title": "EPUB 3 Overview",
                "href" : "http://www.idpf.org/epub/301/spec/epub-overview-20140626.html",
                "rawDate": "2014-06-26",
                "status" : "Recommended Specification",
                "publisher": "IDPF"
            },
            "OCF": {
                "authors": [
                  "James Pritchett",
                  "Markus Gylling"
                ],
                "title": "EPUB Open Container Format (OCF) 3.0",
                "href" : "http://www.idpf.org/epub/301/spec/epub-ocf-20140626.html",
                "rawDate": "2014-06-26",
                "status" : "Recommended Specification",
                "publisher": "IDPF"
            },
            "EPUBCFI": {
                 "authors": [
                  "Peter Sorotokin",
                  "Garth Conboy",
                  "Brady Duga",
                  "John Rivlin",
                  "Don Beaver",
                  "Kevin Ballard",
                  "Alastair Fettes",
                  "Daniel Weck"
                ],
                "title": "EPUB Canonical Fragment Identifier (epubcfi) Specification",
                "href" : "http://www.idpf.org/epub/linking/cfi/epub-cfi.html",
                "rawDate": "2014-06-26",
                "status" : "Recommended Specification",
                "publisher": "IDPF"
            },
            "ODF": {
                "authors": [
                  "Michael Brauer",
                  "Patrick Durusau",
                  "Gary Edwards",
                  "David Faure",
                  "Tom Magliery",
                  "Daniel Vogelheim"
                ],
                "title": "Open Document Format for Office Applications v1.0",
                "href" : "https://www.oasis-open.org/committees/download.php/12572/OpenDocument-v1.0-os.pdf",
                "rawDate": "2005-05-01",
                "status" : "Oasis Standard",
                "publisher": "Oasis"
            },
            "OOXML": {
                "authors" : [
                  "ECMA International"
                ],
                 "title": "Office Open XML File Formats, ECMA-376",
                "href" : "http://www.ecma-international.org/publications/standards/Ecma-376.htm",
                "rawDate": "2012-12",
                "status" : "Standard ECMA 376",
                "publisher": "ECMA"
            },
		    "web-manifest": {
		        "title": "Manifest for web application",
		        "href" : "https://w3c.github.io/manifest/",
		        "rawDate": "2015-02-23",
		        "status" : "ED",
		        "publisher": "W3C"
		    },
            "web-packaging": {
                "authors": [
                  "Jeni Tennison"
                ],
                "title": "Packaging on the Web",
                "href" : "http://www.w3.org/TR/web-packaging/",
                "rawDate": "2015-01-15",
                "status" : "WD",
                "publisher": "W3C"
            },
            "ONIX": {
                "authors": [
                  "EDItEUR"
                ],
                "title": "ONIX for Books 3.0.2 Specification",
                "rawDate": "2014-01-02",
                "publisher": "EDItEUR"
            },

            "BigJava" : "Cay Horstmann. <em>Big Java Late Objects</em>, John Wiley &amp; Sons, Inc., 2013",
            "web-workers" : {
                "authors": [
                  "Ian Hickson"
                ],
                "title": "Web Workers",
                "href" : "https://w3c.github.io/workers/",
                "rawDate": "2014-05-19",
                "status" : "ED",
                "publisher": "W3C"
            },
            "file-uri-scheme" : {
              "authors": [
                "M. Kervin"
              ],
              "title": "The file URI Scheme",
              "href" : "https://tools.ietf.org/html/draft-ietf-appsawg-file-scheme-03",
              "rawDate": "2015-07-23",
              "status" : "Internet Draft",
              "publisher": "IETF"
            },
            "CSV" : {
              "authors" : [
                "Yakov Shafranovich"
              ],
              "title" : "Common Format and MIME Type for Comma-Separated Values (CSV) Files",
              "href" : "http://tools.ietf.org/html/rfc4180",
              "rawDate" : "2015-10",
              "status" : "Informational RFC",
              "publisher": "IETF"
            },
            "ISBN-URN" : {
              "authors" : [
                "J. Hakala",
                "H. Walravens"
              ],
              "title" : "Using International Standard Book Numbers as Uniform Resource Names",
              "href" : "http://tools.ietf.org/html/rfc3187",
              "rawDate" : "2001-10",
              "status" : "Informational RFC",
              "publisher": "IETF"
            },
            "UUID" : {
              "authors" : [
                "P. Leach",
                "M. Mealling",
                "R. Salz"
              ],
              "title" : "A Universally Unique IDentifier (UUID) URN Namespace",
              "href" : "http://tools.ietf.org/html/rfc4122",
              "rawDate" : "2005-07",
              "status" : "Informational RFC",
              "publisher": "IETF"
            },
            "dpub-pwp-ucr" : {
                "authors" : [
                    "Heather Flanagan",
                    "Romain Deltour",
                    "Dave Cramer"
                ],
                "title" : "Portable Web Publications Use Cases and Requirements",
                "href" : "http://w3c.github.io/dpub-pwp-ucr/",
                "publisher" : "W3C",
                "status": "Editors’ Draft"
            }
          },

          // These may become useful if the document gets a more 'official' status
          // postProcess : [ postProc ],

          doRdfa: "true",

          // specification status (e.g. WD, LCWD, WG-NOTE, etc.). If in doubt use ED.
          specStatus:           "ED",

          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "pwp",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          // subtitle   :  "White Paper",

          // if you wish the publication date to be other than the last modification, set this
          // publishDate:  "2015-06-30",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          copyrightStart: "2015",

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          previousPublishDate:  "2016-03-16",
          previousMaturity:  "WD",

          // if there a publicly available Editor's Draft, this is the link
          edDraftURI:           "http://w3c.github.io/dpub-pwp/",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
             {
                  name:       "Markus Gylling"
              ,   mailto:     "mgylling@idpf.org"
              ,   company:    "IDPF"
              ,   companyURL: "http://idpf.org"
              ,   w3cid:      "21614"
              },
              {
                  name:       "Ivan Herman"
              ,   mailto:     "ivan@w3.org"
              ,   company:    "W3C"
              ,   companyURL: "http://www.w3.org"
              ,   url:        "http://www.w3.org/People/Ivan/"
              ,   extras:     [{
                    name:  "<img src='figures/orcid_logo.png' />",
                    href:  "http://orcid.org/0000-0003-0782-2704",
                    class: "orcid"
                  }]
              ,   w3cid:      "7382"
              },
              {
                  name:       "Tzviya Siegman"
              ,   mailto:     "tsiegman@wiley.com"
              ,   company:    "John Wiley & Sons, Inc."
              ,   companyURL: "http://www.wiley.com"
              ,   w3cid:      "65542"
              }
          ],

          // name of the WG
          wg:           "Digital Publishing Interest Group",

          // URI of the public WG page
          wgURI:        "http://www.w3.org/dpub/IG/",

          // name (without the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "public-digipub-ig",

          issueBase: "https://github.com/w3c/dpub-pwp/issues/",


          noRecTrack : "true",

          otherLinks: [
            {
              key: "Repository",
              data: [{
                value: "Github Repository",
                href: "https://github.com/w3c/dpub-pwp"
              }]
            },
            {
              key: "Issues tracker",
              data: [{
                value: "Github Issue Tracker",
                href: "https://github.com/w3c/dpub-pwp/issues"
              }]
            },
            {
              key: "Changes",
              data: [{
                  value: "Diff to previous version",
                  href: "diff.html"
                }, {
                  value: "Commit history",
                  href: "https://github.com/w3c/dpub-pwp/commits/gh-pages"
              }]
            }
           ],

          alternateFormats: [
            {
              uri: "pwp.epub",
              label: "ePub"
            }
          ],

          charterDisclosureURI : "http://www.w3.org/2004/01/pp-impl/64149/status",

          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/64149/status",
          // !!!! IMPORTANT !!!! MAKE THE ABOVE BLINK IN YOUR HEAD
      };
    </script>
  </head>
  <body>
    <section id="abstract">
        <blockquote class="quote"><p>“A book is a discrete collection of text (and other media), that is designed by an author(s) as an internally complete representation of an idea, or set of ideas; emotion or set of emotions; and transmitted to readers in various formats.”</p>
        <p class="author">Hugh McGuire, W3C Track on Digital Publishing at the WWW2016 Conference, April 2016</blockquote>

      <p>This document introduces Portable Web Publications, a vision for the future of digital publishing that is based on a fully native representation of documents within the Open Web Platform. Portable Web Publications achieve full convergence between online and offline/portable document publishing: publishers and users won't need to choose one or the other, but can switch between them dynamically, at will. Authors can concentrate on the way they intend to transmit their ideas and emotions, without having to deal with the specificities of a particular format.
      </p>
    </section>

    <section id='sotd'>
      <p>This document outlines a general vision and should not be considered a technical specification. Instead, its goal is to outline that vision and a possible technical directions to achieve it. A more detailed and rigoruous specification should be done by a separated, dedicated Working Group.</p>
    </section>

    <section>
      <h2 id="introduction">Our Vision</h2>

      <p class="vision">Our vision for <a>Portable Web Publications</a> is to define a class of documents on the Web that would be part of the Digital Publishing ecosystem but would also be fully native citizens of the <a href="https://www.w3.org/wiki/Open_Web_Platform">Open Web Platform</a>.  In this vision, the current format- and workflow-level separation between offline/portable and online (Web) document publishing is diminished to zero. These are merely two dynamic manifestations of the same publication: content authored with online use as the primary mode can easily be saved by the user for offline reading in portable document form. Content authored primarily for use as a portable document can be put online, without any need for refactoring the content. Publishers can choose to utilize either or both of these publishing modes, and users can choose either or both of these consumption modes. Essential features flow seamlessly between online and offline modes; examples include cross-references, user annotations, access to online databases, as well as licensing and rights management.
      </p>

      <p>A more precise technical definition of <a>Portable Web Publications</a> is provided in the section <a href='#pwp_definition'></a>. For the sake of this introduction, suffices to say that a <a>Portable Web Publication</a> is a collection of content items (e.g. pages, chapters, modules, articles) whose content is compatible with Web usage, and structured as a single, self-contained logical unit. Individual items can consist of text, images, graphics, possibly interactive mathematical or chemical formulae, as well as audio and video. These documents, by definition, have a default, linear “reading order”, however the user may choose to skip around in the content just as with a book on paper; alternatively, interactive aspects of the content may alter the reading order on behalf of the user.
      </p>
    </section>

    <figure id="pwp_figure" >
      <img src="figures/pwp.svg" alt="Image showing a laptop accessing unpackaged multiple files for online use.  With same content packaged for use on a mobile cellphone.">
      <figcaption>The same content can be turned into an archived file and back without any inherent changes to the core content or associated digital assets. (Picture is available directly <a href="figures/pwp.svg">SVG</a> or <a href="figures/pwp.png">PNG</a> formats.)</figcaption>
    </figure>

    <section>
      <h2 id="whynow">Why work on this now?</h2>

      <p>Digital Publishing can be considered to be at a tipping point. Digital publishing formats like EPUB have been broadly adopted globally for trade ebooks, and are starting to gain adoption among textbook publishers as well as corporate marketing departments. However, these formats have largely been seen as “offline” formats up until now. Various browser extensions supporting such complex publications exist, and other solutions are available for delivering these publications in browsers. Browser- and cloud-based solutions require relatively complex server and/or client software. In many cases browser- and cloud-based solutions depend on a proprietary transformation of the packaged files into formats more suitable to network delivery. A focused effort to make digital publications first-class Open Web Platform citizens will result in a significant reduction in the complexity of deploying publishing content into browsers for both online and offline consumption. Further, this focused effort will increase the momentum of digital publication and associated Web adoption across communities who are looking for an open, non-proprietary, next-generation portable document format.</p>

      <p>The broader Web Platform can also be considered to be at a tipping point. Mobile platform web site use is diminishing in favor of native applications. Hybrid applications that use web content alongside native application technology, and web-technology-based system applications are growing. The specific means of delivering hybrid and web-technology-based system applications is currently proprietary to specific applications frameworks and/or browser platforms. The point of Portable Web Publications is to increase problem solving momentum in package, metadata, and offline support applicable to both portable publications and installed applications. Open and native solutions to replace proprietary packaging, metadata, and offline support are intended to ensure the broadest possible general adoption of the Open Web Platform.
      </p>

      <p>In many respects, the convergence is already happening. In a number of areas (e.g., educational publications, travel books, etc.) publishers already exploit the advanced possibilities of packaged publishing formats to produce highly interactive documents whose features are very close to what one is used to on the Web (see the separate section <a href="#epub-relations"></a> for some examples). And the converse is also true: tutorial and introductory articles have appeared on the Web that have the quality of traditional publications that one was used to seeing in a scientific magazine, but combined with the interactive possibilities of the Web (<a href="http://bost.ocks.org/mike/algorithms/">Mike Bostock’s article on visualizing algorithms</a> or <a href="http://worrydream.com/LadderOfAbstraction/">Bret Victor’s article on visualization</a> are just two of several possible examples). However, the convergence still has a long way to go, and this is the topic that this document, and the concept of <a>Portable Web Publications</a>, aim to explore.
      </p>

      <p>A companion document&nbsp;[dpub-pwp-ucr] collects more detailed use cases and requirements for <a>Portable Web Publications</a>. The present document concentrates on the technical challenges to achieve this vision, and provides some technical directions addressing those challenges. None of the the technical solutions should be considered final; a more detailed and rigoruous specification should be done by a separate, dedicated Working Group.

    </section>


    <section id="terminology">
      <h2>Terminology</h2>
      <p>This document is based on the following definitions.</p>

      <section id="pwp_definition">
        <h2>Portable Web Publications</h2>

        <ul class="definition">
          <li> A <dfn>Web Resource</dfn> is a digital resource that can be uniquely addressed by a [[URL]] or a [[file-uri-scheme]], i.e., whose content can be accessed through standard network protocols such as HTTP, FTP, or the File Protocol.</li>

          <li><dfn>Content</dfn> of a <a>Web Resource</a>: information and sensory experience to be communicated to the user by means of a user agent, including code or markup that defines the content’s structure, presentation, and interactions.</li>

          <li><dfn data-lt="essential">Essential Content</dfn> of a <a>Web Resource</a>: <a>content</a> which, if removed, would fundamentally change the information or <a>functionality</a> of the <a>Web Resource</a>.</li>

          <li><dfn>Functionality</dfn> related to a <a>Web Resource</a>: processes and outcomes achievable through user action.</li>

          <li>A <dfn data-lt="Web Publications">Web Publication</dfn> is a <a>Web Resource</a> which itself is an aggregated set of interrelated <a data-lt="Web Resource">Web Resources</a>, and which is intended to be considered as a single <a>Web Resource</a>. Furthermore:
            <ul>
              <li>As a <a>Web Resource</a>, a <a>Web Publication</a> has its own [[URL]] which refers to the <em>full set</em> of the constituent resources (as opposed to a particular <a>Web Resource</a> <em>within</em> the <a>Web Publication</a>).</li>

              <li>A <a>Web Publication</a> must be constructed of resources whose formats enable (individually or in conjunction with other resources in the same <a>Web Publication</a>) delivery of <a>essential content</a> and <a>functionality</a> when delivered via a variety of technologies or delivery platforms. In particular, the essential constituents of a <a>Web Publication</a> must be based on technologies of the <a href="https://www.w3.org/wiki/Open_Web_Platform">Open Web Platform</a>.</li>

              <li>A <a>Web Publication</a> should provide a gracefully degrading experience when delivered via a variety of technologies or delivery platforms.</li>

              <li>A <a>Web Publication</a> should provide accessible access to <a>content</a>.</li>

              <li>A <a>Web Publication</a> is not an object with a precise technical meaning, e.g., it is not necessarily equivalent to an HTML Document.</li>
            </ul>
          </li>

          <li>A <a>Web Resource</a> within a <a>Web Publication</a> is <dfn data-lt="Portable Web Resource|Portable Web Resources">Portable</dfn> if an OWP compliant user agent can render its <a>essential content</a> by relying essentially on the <a data-lt="Web Resource">Web Resources</a> within the same <a>Web Publication</a></li>

          <li>A <dfn data-lt="Portable Web Publication|Portable Web Publications|PWP">Portable Web Publication</dfn> (PWP) is a <a>Web Publication</a> whose constituent <a data-lt="Web Resource">Web Resources</a> are all <a data-lt="Portable Web Resource">Portable</a>.</li>
        </ul>

        <p class="note">See the separate section <a href="#identification"></a> for further details on addressing <a>Web Publications</a>.</p>

        <p id="pwp_content"><a data-lt="Web Resource">Web Resources</a> in a <a data-lt="Portable Web Publication">(Portable) Web Publication</a> are based on the core <a href="https://www.w3.org/wiki/Open_Web_Platform">Open Web Platform</a> technologies like [[html5]], [[svg]], [[css21]] and CSS3 modules, or [[ECMAScript]] API-s. A <a>Web Publication</a> may also include images, audio and video, metadata files, executable code in, for example, <a href="http://ipython.org/">iPython</a> or <a href="http://www.maplesoft.com/products/maple/">Maple</a> scripts, or datafiles in [[CSV]]: <a data-lt="Web Resource">Web Resources</a> that are needed to render the <a>essential content</a> of the publication.</p>

        <p>The differences between the distinguishing characteristics of <a>Web Publications</a> and <a data-lt="Portable Web Publication"><span style="text-decoration:underline">Portable</span> Web Publications</a> can be viewed as situational and gradual rather than as representative of bright-line distinctions. Consider the following example:</p>

        <aside class="example">
           <p>The usage of a particular font within a <a>Web Publication</a> may be regarded as non-essential and its font file may therefore be missing from the publication; because the user agent can fall back on a system font, thereby rendering the <a>essential content</a> of the publication, this particular publication may be considered as portable. In other cases, however, the font is <a>essential</a> for the content (e.g., because the font represents mathematical or musical symbols) in which case the <a>Web Publication</a> may be considered as portable only if the font files are part of the constituent set.</p>
        </aside>

        <p class="note">The concepts of <a>content</a>, <a>essential content</a>, and <a>functionality</a> have been taken over from the W3C Web Content Accessibility Guidelines[[WCAG20]], thought slightly modified for this context.</p>

        <div class="issue" data-number="11">The reference to the File URI Scheme[[file-uri-scheme]] may be removed in future.</div>

      </section>

      <section id="state_definition">
        <h3>States of a Portable Web Publication</h3>

        <p>The states of a <a>Portable Web Publication</a> can be separated into two different axes. These different states require a different behavior from the user agent, while some of the characteristics of the publication may be invariant across states. The different states are as follows:</p>

        <ol class="definition">
          <li><strong>States related to the organization of the <a data-lt="Web Resource">Web Resources</a></strong>: A <a>Portable Web Publication</a> is in
            <ul>
              <li><dfn data-lt="Packed">Packed State</dfn>: when all constituents <a data-lt="Web Resource">Web Resources</a> are combined into one unit for storage in a file system, network transfer, etc.</li>
              <li><dfn data-lt="Unpacked">Unpacked State</dfn>: when all constituent <a data-lt="Web Resource">Web Resources</a> can be directly accessed individually through standard network protocols like HTTP, FTP, etc., or through file system access</li>
            </ul>
          </li>

          <li><strong>States related to the access of <a data-lt="Web Resource">Web Resources</a></strong>: A <a>Portable Web Publication</a> is in
            <ul>
              <li><dfn data-lt="Protocol">Protocol State</dfn>: when all constituent <a data-lt="Web Resource">Web Resources</a>, as well as the <a>Portable Web Publication</a> itself, are accessed through network protocols like HTTP, HTTPS, or FTP</li>
              <li><dfn data-lt="File">File State</dfn>: when all constituent <a data-lt="Web Resource">Web Resources</a>, as well as the <a>Portable Web Publication</a> itself, are accessed as files on a local file system</li>
            </ul>
          </li>
        </ol>

        <p>The table below shows the same publication (PWP) in the most typical states:</p>

        <table class="zebra">
          <tbody>
            <tr>
              <th></th>
              <th>Protocol</th>
              <th>File</th>
            </tr>
            <tr>
              <th>Packed</th>
              <td>PWP as one archive file on a Web Server</td>
              <td>PWP as one archive file on a local disc</td>
            </tr>
            <tr>
              <th>Unpacked</th>
              <td>PWP spread over several files on a Web Server</td>
              <td>PWP spread over several files on a local disc</td>
            </tr>
          </tbody>
        </table>

        <p class="note">The difference between <a>protocol</a> and <a>file</a> states is not identical, although close, to the difference between the commonly used notions of “online” vs. “offline”. A PWP can be on a local disc but accessed through a Web Server running on that machine (i.e., through a <code>http://localhost</code> URL): the PWP is in a <a>protocol</a> state, though clearly “offline”. Similarly, a remote file system can be mounted as a local disc, in which case a PWP can be accessed as a file, i.e., is in a <a>file</a> state, though possibly “online”. </p>
      </section>
    </section>

    <section>
      <h2>Achieving convergence: work areas</h2>

      <p>This section lists some of the work areas that activities around <a>Portable Web Publications</a> should engage in. The list is not exhaustive and there are only hints at the technical solutions; one of the main goals of the work ahead will be to clarify the requirements and technical details. It must be emphasized that the solutions to these problems may not come exclusively from W3C, but possibly from other, external organizations (document identification is a typical example).</p>

      <section id="arch">
        <h3>General Architecture for Portable Web Publications</h3>

        <p id="sworkers">The latest evolution of browser technologies around Web Workers[[web-workers]] and Service Workers[[service-workers]] may fundamentally change the way browsers operate in terms of offline/online. Service Workers will provide a flexible and programmable way to efficiently implement local caching of <a data-lt="Web Resource">Web Resources</a>. Caching is implemented as a programmable network proxy, meaning that the browser’s rendering engine becomes oblivious to whether a resource originates from the local cache or directly from the network. </p>

        <p>This evolution makes it possible to bring <a>Portable Web Publications</a> under the same abstraction as a <a>Web Resource</a> identified by a URL. A specialized service worker can cache resources, i.e., can bridge the differences between the offline and online access of a document. Furthermore, by adding additional functionalities to the service worker, it can also deal with possible (un)packaging as well as bridging the differences between <a>protocol</a> and <a>file</a> states. In other words, the core rendering engine of a user agent can operate <strong>as if the <a>Portable Web Publication</a> was in <a>unpacked</a> and <a>protocol</a> states, with all resources available</strong>; the differences are handled by the service worker acting as a proxy.</p>

        <figure style="text-align: center;" id="workers_basic">
          <img src="figures/Workers-basic.png" alt="A laptop computer gaining access to the unpackaged publication from a web browser connecting to a Server with HTTP requests.">
          <figcaption>Accessing a <a>Portable Web Publication</a> in an <a>unpacked</a> state directly from the Web. (Picture is available directly <a href="figures/Workers-basic.svg">SVG</a> or <a href="figures/Workers-basic.png">PNG</a> formats.)</figcaption>
        </figure>

        <figure style="text-align: center;" id="workers_package">
          <img src="figures/Workers-package.png" alt="A laptop computer gaining access to the packaged publication from a web browser connecting to a Server via service workers.">
          <figcaption>Accessing a <a>Portable Web Publication</a> in <a>packed</a> state from the Web via a PWP Processor. (Picture is available directly <a href="figures/Workers-package.svg">SVG</a> or <a href="figures/Workers-package.png">PNG</a> formats.)</figcaption>
        </figure>

        <p class="note">This architecture needs some special care when handling a <a>Portable Web Publication</a> on a local file system. This is because Service Workers operate using the <code>HTTPS</code> (or <code>HTTP</code> for <code>localhost</code>) protocol only, i.e., the <code>file:///</code> protocol is not understood. A possible approach, already implemented in some experimental code, is to start up a local HTTP server serving the resources within the <a>Web Publication</a>. See also <a href="https://github.com/w3c/dpub-pwp/issues/11">Issue 11</a>.</p>
      </section>

      <section id="package">
        <h4>Archive formats</h4>

        <p>Regardless of the details of the practical architecture realizing <a>Portable Web Publications</a>, an archive format is necessary for the storage of a publication as one file (e.g., for distribution or possibly archiving) defined as the <a>packed</a> state of a <a>Portable Web Publication</a>. A variety of formats for offline/archival storage of collections of digital resources exist today [[OCF]], [[ODF]], [[OOXML]], but none of them is universally recognized and supported across all ecosystems. Depending on the general architecture, <a>Portable Web Publications</a> may use one of the deployed formats (e.g., the current EPUB packaging format based on [[OCF]]), or an archive format that is generic and native to the Open Web Platform. </p>

        <p>W3C’s <a href="http://www.w3.org/WebPlatform/WG/">Web Platform Working Group</a> has published a Working Draft for a Streamable Package Format for the Web[[web-packaging]] to encompass the needs of various applications (like installing Web Applications or downloading data for local processing). It is not clear at this moment whether browsers will adopt this format, though. </p>

        <p>However, the importance of streaming is not paramount for <a>Portable Web Publications</a>. Indeed, the same publication may be accessed by the same user from different clients; if some user-dependent management also keeps track of the latest reading position in the publication, switching from one client to the other may mean that a client would have to “jump” <em>into</em> the content, thereby bypassing streaming. Nevertheless, if browsers, eventually, do converge towards a browser and streaming friendly packaging format, adopting it for <a>Portable Web Publications</a> may become a real alternative. The community will have to balance native browser availability against the the wide availibility of tooling and industry distribution based on [[OCF]].</p>

        <div class="note">
          <p>The IETF has published an <a href="https://tools.ietf.org/html/draft-seantek-kerwin-arcmedia-type-01">informational draft on a top-level media type for archives</a>. Although that draft does not specify a specific archive format, and the work is currently on hold, it shows the overall interest in packaging on the Web in line with the concerns of <a>Portable Web Publications</a>.</p>
        </div>
      </section>

      <section id="manifest">
        <h3>Publication Manifests</h3>

        <p>The <dfn>manifest</dfn> of <a>Portable Web Publications</a> is a <a>Web Resource</a> that includes information pertaining to the overall publication structure, such as the default logical reading order(s) of the set of resources that comprise the publication (the “spine”), as well as predictable user-facing meta-structures, such as one or several tables of contents, glossaries, etc. As described in the separate section <a href="#identification"></a> that overall structural information may be what a client would return on a request for a <a>Portable Web Publication</a> instance, as an abstraction for a collection of <a data-lt="Web Resource">Web Resources</a>. For <a>Portable Web Publications</a> it may be imperative to optimize these data structures in a way that is native to the Open Web Platform and more easily supported in authoring tools, browsers, and Reading Systems. </p>

        <p class="note">The Manifest for web application format[[web-manifest]], currently developed at W3C, is one example of a technology that could potentially be used, or adopted, to achieve this goal. Note, however, that the [[web-manifest]] specification is (currently) geared towards Web Applications, which may not make it suitable for direct adoption for <a>Portable Web Publications</a>; hence the possible needs of adoption rather than using it directly.</p>

        <p class="note">Whilst these information objects are important for larger and/or more complex publications, it is unnecessary for other use cases of <a>Portable Web Publications</a>. A typical example is the archival of a single Web page with all the necessary style sheets, images, and similar resources. The definition for <a>Portable Web Publications</a> should therefore include the definition of a set of “defaults”, i.e., it should not require the presence of, say, a spine if the publication contains one single HTML file.</p>
      </section>

      <section id="identification">
        <h3>Addressing and Identification</h3>

        <p>HTTP(S) URLs serve as the fundamental method for addressing a resource, or a fragment thereof, on the Web. Such URLs can also be used to uniquely <em>identify</em> a resource; however, conceptually, the role of addressing and identification are different. <em>Both</em> of these functionalities should be available for <a>Portable Web Publications</a>: a publication should be uniquely identified for, e.g., library catalogues or archival, and a resource locator should be available so that the user could access the content. In other words, a <a>Web Publication</a> (whether portable or not) SHOULD have both one or even possibly several <em>identifier(s)</em> and one <em>locator</em>. These may be be identical but may also be different: e.g., an identifier may refer to a specific publication by a publisher (e.g., using an <a href="https://www.isbn-international.org/">ISBN</a>), whereas the locator may refer to a personal copy of that publication that the owner can freely annotate for personal use.</p>

        <p class="note">A typical, and extremely important use case for the presense of an <em>identifier</em> beyond the need for a <em>locator</em> is in academic and scholarly publishing. There are currently several methods for citing online works, but there is no equivalent standard method for citations to ebooks. Even if a reflowable ebook is by a scholar, the author must refer to PDF, paper copy, or HTML version to cite it in her bibliography. Identifiers attached to <a>Portable Web Publications</a> should enable stable citations.</p>

        <div class="note">
          <p>A general [[URI]] (which includes the notion of [[URL]]) can serve as an <em>identifier</em> using, e.g., the [[ISBN-URN]] or [[UUID]] schemes. In other words, an identifier does not necessarily resolves to a location on the Web, although it is a good practice to have a dereferencable identifier.</p>

          <p> There is no  ubiquitously accepted method for identifying a publication among the various document formats (whether electronic or printed). Within the scholarly publishing industry, for example, initiatives such as <a href="http://www.doi.org">DOI</a> and <a href="http://crossref.org">CROSSREF</a> have addressed this problem, whereas traditional “trade” publishing rely more on <a href="https://www.isbn-international.org/">ISBN</a> related services. Some of these identifier schemes provide resolver services or a “standard” representation in term of [[URL]]. The definition of <a>Portable Web Publication</a> should be oblivious to the exact identification used; this issue is left to specialized services and industry organizations. </p>
        </div>

        <div class="issue" data-number="12">Do we need a more general form of identification to represent scopes?</div>

        <p>For the purpose of the general architecture of <a>Portable Web Publications</a> this document concentrates on <em>locators</em>; as far as identifiers are concerned, the only important point is that such identifier SHOULD also exist and made available, and that they should be stable across, for example, copying the publication or changing its location on the Web. Also, based on the discussion in <a href="#arch"></a>, only the <a>unpacked</a> and <a>protocol</a> states of <a>Portable Web Publications</a> are discussed.</p>

        <p>There are a number of different aspects of addressing that should be specified for a <a>Portable Web Publication</a>. Some of these are follows:</p>

        <section>
          <h4>What should be the response of an HTTP(S)&nbsp;GET request?</h4>
          <p>Conceptually, it should be the <a>manifest</a> of the publication which, in fact, “represents” the <a>Web Publication</a> as a whole. In practice, this means providing access to the corresponding manifest file through either:</p>

          <ul class="definition">
            <li>returning the <a>manifest</a> itself; or</li>
            <li>returning another content (e.g., the first chapter in the document) but providing a link to the <a>manifest</a> through a <code>LINK:</code> in the HTTP response header; or</li>
            <li>returning and HTML content (e.g., the first chapter in the document) but providing a link to the <a>manifest</a> through a <code>&lt;link&gt;</code> element.</li>
          </ul>

          <p>These possibilities are not mutually exclusive.</p>
        </section>

        <section>
          <h4>What is the URL for one of the resources <em>within</em> a <a>Portable Web Publication</a>?</h4>

          <p>I.e.: if the <code>http://www.ex.org/doc.pwp</code> locator refers to the <a>Portable Web Publication</a> as a whole, what is the URL for one of its constituent resources, e.g., <code>chapter1.html</code>?</p>

          <p>The simplest approach is to consider the URL of the <a>Web Publication</a> as the base for all relative URL-s, meaning that the location of the constituents are of the form: <code>http://www.ex.org/doc.pwp/chapter1.html</code> where <code>http://www.ex.org/</code> is the URL of the the <a>Web Publication</a> itself. In other words, the locator of the <a>Web Publication</a> sets the “context”.</p>

          <p>This simple approach works well if the <a>Web Publication</a> is created from bottom up; however, it does rely on a particular organization of the resources. The scheme does not work if the <a>Web Publication</a> (which is defined to be a set of <a data-lt="Web Resource">Web Resources</a>) includes resources at many different places on the Web. This issue may be mitigated by adding mappings (“virtual redirections”) of URLs in the <a>manifest</a> of the <a>Web Publication</a>.</p>

          <p class="note">When using the virtual redirections a particular constituent <a>Web Resource</a> may end up having two URL-s: one is its intrinsic URL as a resource on the Web, the other via the URL of the <a>Web Publication</a>.</p>

          <p class="note">Another alternative that is used in practice is to use an explicit separator between the URL for the publication and the rest, yielding, e.g., <code>http://www.ex.org/doc.pwp!chapter1.html</code>. It is not clear what advantages this approach would have.</p>
        </section>

        <section>
          <h4>How does one locate the internal content of a particular constituent resource?</h4>
            <p>The definition of <a>Web Publications</a> should not include any new mechanism at this point; they should rather entirely rely on fragment identifiers as defined and widely used on the Web.</p>

            <p class="note">As examples for the power of fragment identifiers, the <a href="http://www.w3.org/annotation/">W3C Annotation Working Group</a> has a joint deliverable with the <a href="http://www.w3.org/WebPlatform/WG/">W3C Web Platform Working Group</a> called [[FindText]]. Although the specification aims at a programmable API, it may also provide a general framework of identifying specific textual content within, e.g., and HTML file through the definion of a fragment identifier. Similarly, the W3C Media Fragments specification[[media-frags]] may prove useful to address some of the use cases. </p>
        </section>
       </section>

      <section id="metadata">
        <h3>Metadata: discovery</h3>
        <p>Throughout the digital publishing industry, highly specialized metadata vocabularies, and serialization forms thereof, are being used. Within book trade publishing as an example, ONIX[[ONIX]] has attained a dominant status as a metadata package that typically exists (in XML form) independently of the publication, and contains not only bibliographic metadata, but also trade information such as pricing. Scholarly publishing, on the other hand, often uses various derivatives of the ubiquitous BibTeX vocabulary.</p>

        <p>While not contradicting the obvious use cases for out-of-line metadata records as used by publishers, retailers and libraries, <a>Portable Web Publications</a> must define a syntax for basic in-line metadata records that is agnostic to the publication’s states. This means that the syntax must seamlessly support discovery and harvesting by both generic Web search engines, as well as dedicated bibliographic/archival/retailer systems. While it is expected that <a>Portable Web Publications</a> will define a minimal set of required metadata (cf. the section <a href="#identification"></a>), development and adoption of other vocabularies in <a>Portable Web Publications</a> will most likely be deemed as out of scope. In other words, domain-specific metadata requirements are up to the domains themselves to define via a profiling mechanism, or similar yet-to-be-defined means. </p>

        <p class="note">The adoption of HTML as the vehicle for expressing publication-level metadata (i.e., using RDFa[[html-rdfa]] and/or Microdata[[microdata]] for metadata, like authors or title) would have the added benefits of better I18N support than XML or JSON formats.</p>
      </section>

      <section id="styling">
        <h3>Styling and Layout, Pagination</h3>
        <p>As outlined in [[dpub-latinreq]] or [[dpub-css-priorities]], the Open Web Platform in general, and CSS in particular, is still lacking solutions for meeting all of the publishers’ expectations on satisfactory typography and layout for digital publications. While improved presentation fidelity will be of paramount importance to the overall success and adoption rate of <a>Portable Web Publications</a>, it is clear that many of these issues are going to be addressed on a case-by-case basis by the CSS Working Group over a longer period of time. STM publishing, for example, where the faithful representation and rendering of, say, mathematical or chemical formulae is of a paramount importance, has particularly severe requirements that must be fulfilled by the Open Web Platform technologies. Similarly, dynamic pagination of reflowable content is not natively supported by browsers today, and as a result Reading System developers, for example, are forced to implement pagination using various ad-hoc approaches, all coming with a significant penalty in terms of development costs, performance and stability.</p>

        <p>It is anticipated that native support for pagination (in CSS and/or in the DOM) is going to be put forward by stakeholders as a critical component of <a>Portable Web Publications</a>; thus the finalization of <a>Portable Web Publications</a> may be contingent on the availability of a native pagination model for Web content.</p>

        <p class="note">Note that the <a href="https://wiki.css-houdini.org/">“Houdini” Task Force</a>, recently started jointly by the W3C CSS WG and the W3C TAG, may open new avenues to handle pagination.</p>
      </section>

      <section>
        <h3>Security Models</h3>

        <p>The security model of the Web, based primarily on the same-origin policy and the concept of “site”, does not apply to portable documents, as the notion of “origin” is based on HTTP properties that are invalidated/non-existent when a document transitions from its online state to the portable state. Portable Web Publications must incorporate a state agnostic security model that defines rules for both the online and portable states.</p>
      </section>

      <section>
        <h3>Presentation Control and Personalization</h3>

        <p>When reading long-form (and sometimes mission-critical) publications, personalization—i.e., the ability for users to adapt the presentation to suit their needs—is of a great importance. While technologies such as CSS Media Queries have come a long way in terms of adapting content to devices, this is not the same thing as adapting to a user. Presentation control features are often available in e-book readers of different kinds, for example the possibility to dynamically change font size or background/foreground color schemes, but implementations are brittle and limited due to the lack of an underlying framework that explicitly supports user adaptation.</p>

        <p><a>Portable Web Publications</a> needs to incorporate an explicit framework for achieving advanced and predictable user-triggered presentation control. (Note that from this perspective, accessibility can be seen just a radical case of personalization.)</p>
      </section>

      <section>
        <h3>Models for embracing domain-specific restrictions and extensions</h3>

        <p>Different domains of digital publishing have vastly different expectations and/or requirements on the nature of the content and their presentation. In the digital comics domain for example, the default presentation form is, traditionally at least, pre-paginated, fixed-form, and image-based, possibly with a set of omnipresent (i.e., cross-publisher) user interaction patterns that are expected to be enabled. On the other hand, for trade publishing the default form is fully reflowable content, where user interaction patterns are defined entirely by the user agent. In educational publishing, the ability to control structure, to include rich domain-specific structural semantics and extensive specialized metadata, are at the basis for enhanced reading system behaviors, as well as predictable content discovery and repurposing. </p>

        <p>To allow for the predictability of content within those domains that need it, <a>Portable Web Publications</a> may need to incorporate a notion of “profiles” that content can be authored and validated against, and that user agent implementations can use to trigger enhanced behaviors, if any. To allow for agile feature-set extensions and innovation, <a>Portable Web Publications</a> profiles also needs to embrace the notion of “feature addons” that can be included by a publisher without risking to invalidate the integrity and functionality of the basic publication.</p>
      </section>
    </section>

    <section id="epub-relations">
      <h2>Portable Web Publications and EPUB&nbsp;3</h2>

      <p>The development of the definitions of <a>Portable Web Publications</a> should not be made in isolation, given the diverse publishing ecosystems that already exist. Rather, the development should rely as much as possible on existing and deployed formats, which include both the various Open Web Platform technologies and digital publishing formats.</p>

      <p>Several document formats exist in the digital publishing domain; however, the only vendor independent and HTML based format is EPUB&nbsp;3[[EPUB3]], which emphasizes a dynamic determination of content presentation and a closer alignment with the Open Web Platform.  EPUB&nbsp;3 is built on Web Standards, and the individual items that make up an EPUB publication are identical to types of content on a Web site: [[html5]], [[svg]], [[css21]], [[ECMAScript]], [[JPEG]] and [[png]] images, etc. Various browser extensions supporting EPUB exist (e.g., <a href="https://chrome.google.com/webstore/detail/readium/fepbnnnkkadjhjahcafoaglimekefifl">Readium in Chrome</a>, <a href="http://www.epubread.com/en/">EPUBReader</a> in Firefox). Other solutions exist for delivering these files in browsers (<a href="http://readium.org/">Readium-Cloud</a>, <a href="https://github.com/futurepress/epub.js/">EPUB.js</a>, <a href="https://www.safaribooksonline.com/">Safari Books Online</a>, etc.). Publishers are actively exploring the new and possibly interactive possibilities offered by EPUB&nbsp;3; a good example is <a href="http://bcs.wiley.com/he-bcs/Books?action=index&bcsId=7005&itemId=1118087887">Cay Horstmann’s “Big Java, Late Objects”</a>[[BigJava]] that combines the feel of a traditional book with interactive learning materials that makes it reminiscent of similar, Web based tutorials (see the <a href="http://www.wiley.com/college/sc/horstmann/">video</a> on a companion page for the book)</p>

      <p>Whilst the concept of <a>Portable Web Publication</a> is close to, and has been inspired by, EPUB&nbsp;3, it goes beyond it, insofar as it emphasizes the need for a convergence between the offline and online usages. It would be highly desirable to deliver on the requirements on <a>Portable Web Publications</a> in an evolutionary manner that would build on, and would be backwards compatible with, existing EPUB&nbsp;3, since the latter is already widely deployed. However, this may not be possible. At this stage, this document emphasizes all requirements envisioned for <a>Portable Web Publications</a> without addressing the natural tension between goals of preserving compatibility and fully achieving all these requirements in the most elegant manner. But neither this end-goal emphasis, nor the use of the new term “<a>Portable Web Publication</a>”, should be taken as implying a recommendation to definitely create a completely new format that would replace EPUB. Further investigation is required, and the ongoing evolutionary trajectory of EPUB&nbsp;3 must also be taken into account.</p>

      <p class="note">The current evolution of EPUB&nbsp;3 towards EPUB&nbsp;3.1 will address several compatibility and convergence issues with the Open Web Platform; this will make the evolution path towards <a>Portable Web Publications</a> easier.</p>

      <p>It must also be emphasized that the central part of any EPUB&nbsp;3 publication, namely the <em>content</em>, will remain unchanged or will require only minimal changes when transitioning towards <a>Portable Web Publications</a>. The bulk of the changes are expected to occur around the accompanying constructs like publication-level metadata records, the spine, or the packaging format of the content. As described in the section <a href="#pwp_definition"></a>, the content of a <a>Portable Web Publication</a> is based on core <a href="https://www.w3.org/wiki/Open_Web_Platform">Open Web Platform</a> technologies including [[html5]], [[svg]], or [[css21]], and other types of files like images, audio and video, metadata files, or executable code. Most of these are valid contents in EPUB&nbsp;3 already; a transition towards <a>Portable Web Publications</a> will leave these resources and their usage intact. The envisaged changes will be mostly restricted to the implementation details of reading systems and production workflows. The evolution of the past few years of online tooling for the production of EPUB content based on the Open Web Platform (e.g., the platforms developed and used by companies like O’Reilly, Hachette, Metrodigi, or Inkling) will also greatly facilitate any transition to <a>Portable Web Publications</a>; adapting these tools is expected to be quite straightforward.
      </p>
    </section>

    <section>
      <h2>Conclusions</h2>
      <p>This document outlines a vision for the convergence between the Open Web Platform and portable documents while also significantly advancing and expanding the existing digital publishing ecosystem. The realization of this vision would require a strong cooperation between the traditional publishing and Web communities, based on a close collaboration between the W3C and other relevant organizations, like <a href="http://idpf.org">IDPF</a>, <a href="http://editeur.org/">EDItEUR</a>, <a href="http://www.bisg.org">BISG</a>, or others. While it is envisaged that most of the work could be done in one or more dedicated Working Groups (within W3C or elsewhere, depending on the exact charter), it must be emphasized that many of the features will affect and will be affected by work done elsewhere, within or outside these organizations. The starting point will be to explore and plan for the detailed technical challenges to gain a better insight into the work ahead; this exploration should be done together with the various interested communities.
      </p>
    </section>
  </body>
</html>
